# --------------------------------------------------------------------------------------------------------------
# --------------------------------------------------------------------------------------------------------------
# --------------------------------------------------------------------------------------------------------------
#                                       ||     Import Data    ||
# --------------------------------------------------------------------------------------------------------------
# --------------------------------------------------------------------------------------------------------------

setwd("C:/Yashwanth/Clustering/1.Input_data/Data_1")

Bounce_Rate <- read.table(paste0(getwd(),"/Bounce_rate.csv"), 
                          header = TRUE, sep = ",", quote = "\"", dec = "." ,fill=TRUE, comment.char="", as.is=TRUE)

Avg_Time_On_Page <- read.table(paste0(getwd(),"/AvgTimeOnPage.csv"), 
                               header = TRUE, sep = ",", quote = "\"", dec = "." ,fill=TRUE, comment.char="", as.is=TRUE)

Visits <- read.table(paste0(getwd(),"/Visits.csv"), 
                     header = TRUE, sep = ",", quote = "\"", dec = "." ,fill=TRUE, comment.char="", as.is=TRUE)

Prod_Page_Views <- read.table(paste0(getwd(),"/ProductPageViews.csv"), 
                              header = TRUE, sep = ",", quote = "\"", dec = "." ,fill=TRUE, comment.char="", as.is=TRUE)

Page_Views <- read.table(paste0(getwd(),"/Page_Views.csv"), 
                              header = TRUE, sep = ",", quote = "\"", dec = "." ,fill=TRUE, comment.char="", as.is=TRUE)

# --------------------------------------------------------------------------------------------------------------
# --------------------------------------------------------------------------------------------------------------
#                                       || Merge data  ||
# --------------------------------------------------------------------------------------------------------------
# --------------------------------------------------------------------------------------------------------------

GAP_Pages <- data.frame(Bounce_Rate[,1],as.numeric(rowMeans(Bounce_Rate[,-1])),
                  as.numeric(rowMeans(Avg_Time_On_Page[,-1])),
                  as.numeric(rowMeans(Visits[,-1])),
                  as.numeric(rowMeans(Prod_Page_Views[,-1])),
                  as.numeric(rowMeans(Page_Views[,-1])),row.names=NULL)
names(GAP_Pages) <- c("Pages","Bounce_Rate","Avg_Time_On_Page","Visits","Prod_Page_Views","Page_Views")

rm(Bounce_Rate,Avg_Time_On_Page,Visits,Prod_Page_Views,Page_Views)

# --------------------------------------------------------------------------------------------------------------
# --------------------------------------------------------------------------------------------------------------
#                                       || standardization of data  ||
# --------------------------------------------------------------------------------------------------------------
# --------------------------------------------------------------------------------------------------------------

library(clusterSim)
GAP_Pages_Std <- data.Normalization(GAP_Pages[,-1],type="n1")
rownames(GAP_Pages_Std) <- GAP_Pages[,1]

# --------------------------------------------------------------------------------------------------------------
# --------------------------------------------------------------------------------------------------------------
#                                       || Distance Matrix  ||
# --------------------------------------------------------------------------------------------------------------
# --------------------------------------------------------------------------------------------------------------

GAP_Pages_Dist <- data.frame(as.matrix(dist(GAP_Pages_Std,upper=TRUE)))
colnames(GAP_Pages_Dist) <- GAP_Pages[,1]
rownames(GAP_Pages_Dist) <- GAP_Pages[,1]
write.csv(GAP_Pages_Dist,"C:/Yashwanth/Clustering/2.Distance_Matrix/GAP_Pages_Dist_New.csv")


# --------------------------------------------------------------------------------------------------------------
# --------------------------------------------------------------------------------------------------------------
# --------------------------------------------------------------------------------------------------------------
# --------------------------------------------------------------------------------------------------------------
# --------------------------------------------------------------------------------------------------------------
# --------------------------------------------------------------------------------------------------------------
# --------------------------------------------------------------------------------------------------------------
# --------------------------------------------------------------------------------------------------------------
