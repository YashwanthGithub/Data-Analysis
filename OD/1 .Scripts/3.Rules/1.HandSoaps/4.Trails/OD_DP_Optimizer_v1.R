# -----------------------------------------------------------------------------------------------------------------------------------------------#
# -----------------------------------------------------------------------------------------------------------------------------------------------#
# -----------------------------------------------------------------------------------------------------------------------------------------------#
#                                                   || Rules Implementation : Optimizer ||
# -----------------------------------------------------------------------------------------------------------------------------------------------#
# -----------------------------------------------------------------------------------------------------------------------------------------------#
# -----------------------------------------------------------------------------------------------------------------------------------------------#

                                  #       Model  Ln Sales = Int -0.03 (OD Final Price - Staples Final Price)          #
                                  #       Ln S2 - Ln S1 = 0.03 (ODP 1 - STP 1 - ODP2 + STP2)                          #
                                  #       Ln S2 = ln S1 + 0.03(ODP 1 + STP2 - STP 1 - ODP2)                           #
                                  #       S2 = exp(ln S1 = 0.03(ODP1 + STP 2 - STP 1 - ODP2)                          #
          
                                  #       Margin2 = S2 (ODP2 - Cost)                                                  #
                                  #       Margin 2 = exp[ln S1 + 0.03 (ODP 1 + STP 2 - STP 1 - ODP2)]*(ODP2-Cost)     #  

  setwd("C:/Yashwanth/Pricing/1.OfficeDepot/10.Rules/1.Rules_data_files/")
  OD.Handsoap_Optimizer_SKU <- read.table("Optimizer.csv",header = TRUE, sep = ",", quote = "\"", dec = ".",
                                fill=TRUE, comment.char="", as.is=TRUE)

  OD.Handsoap_Optimizer <-  merge(OD.Handsoap_Optimizer_SKU,OD.Handsoap_Rule_1234[c(1,8,3,14,16,6,33,34)],
                                by="SKU",all=TRUE,incomparables=TRUE)
  colnames(OD.Handsoap_Optimizer)[7:8] <- c("ODP_2_Floor","ODP_2_Cap")
  OD.Handsoap_Optimizer$Cost <- round(OD.Handsoap_Optimizer$Cost,2)
  
  OD.Handsoap_Optimizer$ODP_2_Floor <- as.numeric(OD.Handsoap_Optimizer$ODP_2_Floor)
  OD.Handsoap_Optimizer$ODP_2_Cap <- as.numeric(OD.Handsoap_Optimizer$ODP_2_Cap)
  
# -----------------------------------------------------------------------------------------------------------------------------------------------#
#                                                   || ODP values : 0,1,2,3,4,5,6,7,8,9 ||
# -----------------------------------------------------------------------------------------------------------------------------------------------#

  OD.ODP2_Value_seq <- NA
  for(i in seq(0,10,by=1)){
    OD.ODP2_Value_seq[i] <- i-1
  }
    
  ODP2_Value <- NA
  attach(OD.Handsoap_Optimizer)
  for(j in 1:nrow(OD.Handsoap_Optimizer)){
          ODP2_Value[j]  <- (ODP_2_Floor[j]+OD.ODP2_Value_seq[1]*(ODP_2_Cap[j]-ODP_2_Floor[j])/9)
    }
  detach(OD.Handsoap_Optimizer)

    =ODP 2 Floor+ODP_value*($ODP 2 Cap-ODP 2 Floor)/9
  
  
  
  
  cbind(OD.Handsoap_Optimizer_SKU,OD.ODP2_Value1,OD.ODP2_Value2,OD.ODP2_Value3,OD.ODP2_Value4)
  
  
  OD.ODP2_Value[j]  <- 
    OD.ODP2_Value[j]  <- 
    OD.ODP2_Value[j]  <- 
    OD.ODP2_Value[j]  <- 
    OD.ODP2_Value[j]  <- 
    OD.ODP2_Value[j]  <- 
    OD.ODP2_Value[j]  <- 
    OD.ODP2_Value[j]  <- 
    OD.ODP2_Value[j]  <- 
    
  
# -----------------------------------------------------------------------------------------------------------------------------------------------#
#                                                   || OD Margin values : 1,2,3,4,5,6,7,8,9,10 ||
# -----------------------------------------------------------------------------------------------------------------------------------------------#
  
  OD.ODP2_Margin1 <- 
  OD.ODP2_Margin2 <- 
  OD.ODP2_Margin3 <- 
  OD.ODP2_Margin4 <- 
  OD.ODP2_Margin5 <- 
  OD.ODP2_Margin6 <- 
  OD.ODP2_Margin7 <- 
  OD.ODP2_Margin8 <- 
  OD.ODP2_Margin9 <- 
  OD.ODP2_Margin10 <- 


#---------------------------------------------------------------------------------------------------------------
#---------------------------------------------------------------------------------------------------------------
#---------------------------------------------------------------------------------------------------------------
#---------------------------------------------------------------------------------------------------------------
#---------------------------------------------------------------------------------------------------------------
#---------------------------------------------------------------------------------------------------------------
#---------------------------------------------------------------------------------------------------------------
#---------------------------------------------------------------------------------------------------------------
#---------------------------------------------------------------------------------------------------------------




