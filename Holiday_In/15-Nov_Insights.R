###############################################################################################################################################################################################
###############################################################################################################################################################################################

# Importing data Belk's data  ##

read.csv("Z:/BIG/Yashwanth/Holiday Calendar Insights/15_nov_Insight/15-Nov_Insights.csv", header = TRUE, sep = ",", 
		quote = "\"",dec = ".",fill=TRUE)

Retailer_Insight <- read.table("Z:/BIG/Yashwanth/Holiday Calendar Insights/15_nov_Insight/15-Nov_Insights.csv", 
		header = TRUE, sep = ",", quote = "\"",dec = ".",fill=TRUE)
names(Retailer_Insight)


################### Box Plot ####################################################################################################

plot(Retailer_Insight$Retailer_name,Retailer_Insight$Assortment_Count)

barplot(Retailer_Insight[,4])

levels(Retailer_Insight$Retailer_name)

###############################################################################################################################################################################################
###############################################################################################################################################################################################

################### Bar Plot ####################################################################################################

library(RColorBrewer)

display.brewer.all()
brewer.pal.info
BarPlot_One <- table(Retailer_Insight$Retailer_name,Retailer_Insight$Category_name)
barplot(table(Retailer_Insight$Retailer_name,Retailer_Insight$Category_name),
	main = "Assortment distribution by Category and Retailer",
	col=brewer.pal(12,"Paired"),legend=row.names(BarPlot_One))

legend(levels(Retailer_Insight$Retailer_name),
		legend=row.names(BarPlot_One),cex=0.4,pt.cex=cex,ncol=4)

levels(Retailer_Insight$Retailer_name)

###############################################################################################################################################################################################
###############################################################################################################################################################################################

################# Custom Table ############################################################################################

read.csv("Z:/BIG/Yashwanth/Holiday Calendar Insights/15_nov_Insight/Assortment tables.csv", header = TRUE, sep = ",", 
		quote = "\"",dec = ".",fill=TRUE)

Assortment_Insight <- read.table("Z:/BIG/Yashwanth/Holiday Calendar Insights/15_nov_Insight/Assortment tables.csv", 
		header = TRUE, sep = ",", quote = "\"",dec = ".",fill=TRUE)
names(Assortment_Insight)
levels(Assortment_Insight$Retailer)

Custom_Table_Cat_SubCat <- ftable(Assortment_Insight[,1:2])

Custom_Table_Ret_Cat <- ftable(Assortment_Insight[,c(1,3)])

Custom_Table_Ret_SubCat <- ftable(Assortment_Insight[,c(3,2)])


###############################################################################################################################################################################################
###############################################################################################################################################################################################

write.csv(Custom_Table_Cat_SubCat, file = "Z:/BIG/Yashwanth/Holiday Calendar Insights/15_nov_Insight/Custom_Table_Cat_SubCat.csv",
	 append = FALSE, quote = TRUE, sep = " ",
            eol = "\n", na = "NA", dec = ".", row.names=levels(Assortment_Insight$Retailer),
		col.names = TRUE)


###############################################################################################################################################################################################
###############################################################################################################################################################################################
###############################################################################################################################################################################################
###############################################################################################################################################################################################
###############################################################################################################################################################################################
###############################################################################################################################################################################################
###############################################################################################################################################################################################
###############################################################################################################################################################################################
###############################################################################################################################################################################################
###############################################################################################################################################################################################



# Importing data Belk's data  ##

read.csv("Z:/BIG/Yashwanth/Holiday Calendar Insights/15_nov_Insight/Belk_Insight.csv", header = TRUE, sep = ",", 
		quote = "\"",dec = ".",fill=TRUE)

Belk_Insight <- read.table("Z:/BIG/Yashwanth/Holiday Calendar Insights/15_nov_Insight/Belk_Insight.csv", 
		header = TRUE, sep = ",", quote = "\"",dec = ".",fill=TRUE)
names(Belk_Insight)
#Belk_Insight <- cbind(Belk_Insight,log(Belk_Insight$Discounted_Products))
names(Belk_Insight)

###############################################################################################################################################################################################
###############################################################################################################################################################################################

########################## Normality Check ##################################################################################

shapiro.test(Belk_Insight$Assortment_Count) # Normally distributed  ##
shapiro.test(Belk_Insight$Discounted_Products) # Not Normally distributed  ##
shapiro.test(Belk_Insight$average_Price) # Normally distributed  ##
shapiro.test(Belk_Insight$Average_discount...) # Normally distributed  ##


qqplot(Belk_Insight$Assortment_Count)
###############################################################################################################################################################################################
###############################################################################################################################################################################################

############### Descriptives ######################################################################################################

cor(Belk_Insight[,4:7],use="complete.obs")
# If one(Ass_Count) increases other(Dis_prod) decreases or vice-versa #########
# If one(Ass_Count) increases other(Avg_Price) decreases or vice-versa ########
# If one(Ass_Count) increases other(Avg_dis) increases or vice-versa #########


###############################################################################################################################################################################################
###############################################################################################################################################################################################

########################## Linear Model ##################################################################################
## Hypthothesis : H_0: Imapact on Ass_Count v/s H_1: No Imapact on Ass_Count ######################################

Belk_Insight_LM <- lm(Assortment_Count ~ Discounted_Products+average_Price+Average_discount...,
				data=Belk_Insight)
summary(Belk_Insight_LM)
anova(Belk_Insight_LM)

Belk_Insight_LM_Predict <- predict(Belk_Insight_LM)

Belk_Insight_LM_Predict_DF <- cbind(Belk_Insight,Actual=Belk_Insight$Assortment_Count,
						Predicted=Belk_Insight_LM_Predict)

