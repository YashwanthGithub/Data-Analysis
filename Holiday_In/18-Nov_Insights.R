###############################################################################################################################################################################################
###############################################################################################################################################################################################

# Importing data data  ##

read.csv("Z:/BIG/Yashwanth/Holiday Calendar Insights/18_nov_Insight/Internal_Seasonal Shopping_PC Output_QC Done_11 sites_18-Nov-2013_RAKM.csv", header = TRUE, sep = ",", 
		quote = "\"",dec = ".",fill=TRUE)

Insight_Nov_18 <- read.table("Z:/BIG/Yashwanth/Holiday Calendar Insights/18_nov_Insight/Internal_Seasonal Shopping_PC Output_QC Done_11 sites_18-Nov-2013_RAKM.csv", 
		header = TRUE, sep = ",", quote = "\"",dec = ".",fill=TRUE)
names(Insight_Nov_18)

###############################################################################################################################################################################################
###############################################################################################################################################################################################

# Importing Amazon data data  ##

read.csv("Z:/BIG/Yashwanth/Holiday Calendar Insights/18_nov_Insight/Internal_Seasonal Shopping_PC Output_QC Done_Amazon_18-Nov-2013_RAKM.csv", header = TRUE, sep = ",", 
		quote = "\"",dec = ".",fill=TRUE)

Insight_Nov_18_Amz <- read.table("Z:/BIG/Yashwanth/Holiday Calendar Insights/18_nov_Insight/Internal_Seasonal Shopping_PC Output_QC Done_Amazon_18-Nov-2013_RAKM.csv", 
		header = TRUE, sep = ",", quote = "\"",dec = ".",fill=TRUE)

###############################################################################################################################################################################################
###############################################################################################################################################################################################

# Importing Walmart data ##

read.csv("Z:/BIG/Yashwanth/Holiday Calendar Insights/18_nov_Insight/Internal_Seasonal Shopping_PC Output_QC Done_Walmart_18-Nov-2013_RAKM.csv", header = TRUE, sep = ",", 
		quote = "\"",dec = ".",fill=TRUE)

Insight_Nov_18_WalMrt <- read.table("Z:/BIG/Yashwanth/Holiday Calendar Insights/18_nov_Insight/Internal_Seasonal Shopping_PC Output_QC Done_Walmart_18-Nov-2013_RAKM.csv", 
		header = TRUE, sep = ",", quote = "\"",dec = ".",fill=TRUE)


###############################################################################################################################################################################################
###############################################################################################################################################################################################

# Merge all the above data  ##

Merge_ONE <- merge(Insight_Nov_18,Insight_Nov_18_Amz,all.x=TRUE,all.y=TRUE)
Merge_TWO <- merge(Merge_ONE,Insight_Nov_18_WalMrt,all.x=TRUE,all.y=TRUE)
as.data.frame(Merge_TWO)
names(Merge_TWO)

###############################################################################################################################################################################################
###############################################################################################################################################################################################

# Export the merged data to .csv ##

write.csv(Merge_TWO, file = "Z:/BIG/Yashwanth/Holiday Calendar Insights/18_nov_Insight/Final_Data.csv",
	 append = FALSE, quote = TRUE, sep = " ",
            eol = "\n", na = "NA", dec = ".", row.names=FALSE,
		col.names = names(Merge_TWO))


###############################################################################################################################################################################################
###############################################################################################################################################################################################

# Rename merged data  ##

Merge_TWO
names(Merge_TWO)

###############################################################################################################################################################################################
###############################################################################################################################################################################################

# Importing back Merged data  ##

read.csv("Z:/BIG/Yashwanth/Holiday Calendar Insights/18_nov_Insight/Final_Data.csv", header = TRUE, sep = ",", 
		quote = "\"",dec = ".",fill=TRUE)

Final_Data <- read.table("Z:/BIG/Yashwanth/Holiday Calendar Insights/18_nov_Insight/Final_Data.csv", 
		header = TRUE, sep = ",", quote = "\"",dec = ".",fill=TRUE)
names(Final_Data) 

###############################################################################################################################################################################################
###############################################################################################################################################################################################

################# Custom Table ############################################################################################

Custom_Table_Ret_Div <- ftable(Final_Data[,1:2])

Custom_Table_Ret_Cat <- ftable(Final_Data[,c(1,3)])

Custom_Table_Div_Cat <- ftable(Final_Data[,2:3])

################# 3-way Custom Table ############################################################################################

Custom_Table_Ret_Div_Cat <- xtabs(~Final_Data[,1]+Final_Data[,2]+Final_Data[,3])

###############################################################################################################################################################################################
###############################################################################################################################################################################################

# Export the merged data to .csv ##

write.csv(Custom_Table_Ret_Div_Cat, file = "Z:/BIG/Yashwanth/Holiday Calendar Insights/18_nov_Insight/Custom_Table_Ret_Div_Cat.csv",
	 append = FALSE, quote = TRUE, sep = " ",
            eol = "\n", na = "NA", dec = ".", row.names=FALSE,
		col.names = TRUE)


###############################################################################################################################################################################################
###############################################################################################################################################################################################
###############################################################################################################################################################################################
###############################################################################################################################################################################################

############### Charts or true visualization  ######################################################################################
help(all.packages)
install.packages("RColorBrewer",dependencies=TRUE)
library(RColorBrewer)
display.brewer.all()
brewer.pal.info


par(mfrow=c(2,1))
BarPlot_One <- table(Final_Data$Retailer,Final_Data$Division)
barplot(table(Final_Data$Retailer,Final_Data$Division),
	main = "Assortment distribution by Retailer across Division",
	col=brewer.pal(12,"Paired"))

#legend(levels(Retailer_Insight$Retailer_name),
#		legend=row.names(BarPlot_One),cex=0.4,pt.cex=cex,ncol=4)

BarPlot_Two <- table(Final_Data$Retailer,Final_Data$Category)
barplot(table(Final_Data$Retailer,Final_Data$Category),
	main = "Assortment distribution by Retailer across Category",
	col=brewer.pal(12,"Set3"))

levels(Retailer_Insight$Retailer_name)

###############################################################################################################################################################################################
###############################################################################################################################################################################################
###############################################################################################################################################################################################
###############################################################################################################################################################################################

####################### Insights ############################################################################################################################################################

##################### Ftable ###################################################################################################################################################################

Custom_Table_Ret_Div <- ftable(Final_Data[,1:2])

Custom_Table_Ret_Cat <- ftable(Final_Data[,c(1,3)])

###############################################################################################################################################################################################
###############################################################################################################################################################################################

################# Test of significance ##########################################################################################################################################################


chisq.test(Contigency_Table[1,],Contigency_Table[,1])

names(Contigency_Table);row.names(Contigency_Table$Amazon)

##################### Correspondance Analysis  #################################################################################################################################################

write.csv(levels(Final_Data$Division), file = "Z:/BIG/Yashwanth/Holiday Calendar Insights/18_nov_Insight/Div Names.csv",
	 append = FALSE, quote = TRUE, sep = " ",
            eol = "\n", na = "NA", dec = ".", row.names=levels(Final_Data$Retailer),
		col.names = TRUE)

read.csv("Z:/BIG/Yashwanth/Holiday Calendar Insights/18_nov_Insight/Custom_Table_Ret_Div.csv", header = TRUE, sep = ",", 
		quote = "\"",dec = ".",fill=TRUE,row.names=1)

Contigency_Table <- read.table("Z:/BIG/Yashwanth/Holiday Calendar Insights/18_nov_Insight/Custom_Table_Ret_Div.csv", 
		header = TRUE, sep = ",", quote = "\"",dec = ".",fill=TRUE,row.names=1)

library(ca)

summary(ca(Contigency_Table))
plot(ca(Contigency_Table),what="all")

############################ Amz,BBB,Belk,BB ####################################################################################################################################################

read.csv("Z:/BIG/Yashwanth/Holiday Calendar Insights/18_nov_Insight/AM_BBB_BE_BB.csv", header = TRUE, sep = ",", 
		quote = "\"",dec = ".",fill=TRUE,row.names=1)

Contigency_Table_1_4 <- read.table("Z:/BIG/Yashwanth/Holiday Calendar Insights/18_nov_Insight/AM_BBB_BE_BB.csv", 
		header = TRUE, sep = ",", quote = "\"",dec = ".",fill=TRUE,row.names=1)


summary(ca(Contigency_Table_1_4,nd=2))
plot(ca(Contigency_Table_1_4,nd=2))
library()
plot3d.ca(ca(Contigency_Table_1_4))



###############################################################################################################################################################################################
###############################################################################################################################################################################################
###############################################################################################################################################################################################
###############################################################################################################################################################################################
###############################################################################################################################################################################################
###############################################################################################################################################################################################
###############################################################################################################################################################################################
###############################################################################################################################################################################################


